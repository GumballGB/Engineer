#include <Servo.h>
Servo leftservo;  // Servo Name
Servo rightservo; // Servo Name
const int pingPin = 5; // Trigger Pin of Ultrasonic Sensor
const int echoPin = 6; // Echo Pin of Ultrasonic Sensor
double distance;

//THIS IS FOR THE REAL LIFE LAB AND NOT THE SIMULATION

void Scan() //This function actively scans
{
  while (distance > 150) {
    Mileage();
    Serial.println("Scanning for a new wall");
    leftservo.write(180);
    rightservo.write(180);
    delay(400);
    leftservo.write(90);
    rightservo.write(90);
    delay(1000);
    
    if (distance > 50)
    {
      leftservo.write(0);
      rightservo.write(0);
      delay(300);
      Serial.println(distance);
      leftservo.write(120);
      rightservo.write(60);
      delay(600);
    }
  }
}

void StaterFuel() //This function identities the pins
{
  leftservo.attach(9);  
  rightservo.attach(10);
  //set up the Serial
  Serial.begin(9600);
  //setupt the pin modes  
  pinMode(pingPin, OUTPUT);
  pinMode(echoPin, INPUT);
  leftservo.write(90);
  rightservo.write(90);
  Serial.println("Engine Ready");
}

void Mileage() //This function sets up duration
{
  double duration;  
  digitalWrite(pingPin, LOW);
  delayMicroseconds(2); //send the 10 microsecond trigger
  digitalWrite(pingPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(pingPin, LOW); //get the pulse duration in microseconds
  duration = pulseIn(echoPin, HIGH); 
  distance = (duration*0.034/2); //converts duration to time
}

void setup() 
{
  Scan(); //Assume there was no wall.
  StaterFuel();
  Mileage();
  //FIRST GEAR, GRABBING THE COINS UNTIL THE WALL VANISHES
  while(distance < 195) {
    if (distance > 40) 
    { 
      Mileage();
      //
      leftservo.write(60);
      rightservo.write(20);
      delay(50);
      Serial.println("Too Far");
      Serial.println(distance);
    }
    else if (distance < 40) 
    { 
      Mileage();
      //
      leftservo.write(130);
      rightservo.write(80);
      delay(50);
      Serial.println(distance);
      Serial.println("Too Close");
    }
    else 
    { 
      Mileage();
      //
      leftservo.write(150);
      rightservo.write(30);
      delay(25);
    }
  }
  Serial.println("I can't detect a wall!");

//SECOND GEAR, IF WALL VANISHED SCAN FOR MORE
//ROBOT WILL PIVOT FOR A NEW WALL, IF NOT FOUND IT WILL JUST MOVE FORWARD
Scan();
Serial.println("Wall Found");
//THIRD GEAR, ROBOT HAS TO DETECT A NEW WALL   
while(distance < 150) {
  if (distance > 30) 
    { 
      Mileage();
      //
      leftservo.write(60);
      rightservo.write(20);
      delay(50);
      Serial.println("Get Closer");
      Serial.println(distance);
    }
  else if (distance < 30) 
    { 
      Mileage();
      //
      leftservo.write(130);
      rightservo.write(80);
      delay(50);
      Serial.println(distance);
      Serial.println("Get Further");
    }
  else 
    { 
      Mileage();
      //
      leftservo.write(150);
      rightservo.write(30);
      delay(25);

    }
}
Serial.println("Goodnight");
leftservo.write(90);
rightservo.write(90);
} //The bracket closes the entire void setup()

void loop() {
  
}  
